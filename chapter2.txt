This is chapter2 with new changes